{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _isNil2 = require('lodash/isNil');\n\nvar _isNil3 = _interopRequireDefault(_isNil2);\n\nvar _mapValues2 = require('lodash/mapValues');\n\nvar _mapValues3 = _interopRequireDefault(_mapValues2);\n\nvar _first2 = require('lodash/first');\n\nvar _first3 = _interopRequireDefault(_first2);\n\nvar _defer2 = require('lodash/defer');\n\nvar _defer3 = _interopRequireDefault(_defer2);\n\nvar _get2 = require('lodash/get');\n\nvar _get3 = _interopRequireDefault(_get2);\n\nvar _noop2 = require('lodash/noop');\n\nvar _noop3 = _interopRequireDefault(_noop2);\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('react-peek/prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _styleHelpers = require('../../util/style-helpers');\n\nvar _componentTypes = require('../../util/component-types');\n\nvar _DragCaptureZone = require('../DragCaptureZone/DragCaptureZone');\n\nvar _DragCaptureZone2 = _interopRequireDefault(_DragCaptureZone);\n\nvar _reactMotion = require('react-motion');\n\nvar _motionSpring = require('../../constants/motion-spring');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nvar cx = _styleHelpers.lucidClassNames.bind('&-SplitHorizontal');\n\nvar any = _propTypes2.default.any,\n    bool = _propTypes2.default.bool,\n    func = _propTypes2.default.func,\n    node = _propTypes2.default.node,\n    number = _propTypes2.default.number,\n    string = _propTypes2.default.string,\n    oneOfType = _propTypes2.default.oneOfType;\nvar SplitHorizontal = (0, _componentTypes.createClass)({\n  displayName: 'SplitHorizontal',\n  statics: {},\n  _isPrivate: true,\n  propTypes: {\n    className: any,\n    children: node,\n    isExpanded: bool,\n    isAnimated: bool,\n    onResizing: func,\n    onResize: func,\n    collapseShift: number\n  },\n  components: {\n    TopPane: (0, _componentTypes.createClass)({\n      displayName: 'SplitHorizontal.TopPane',\n      statics: {},\n      propTypes: {\n        children: node,\n        height: oneOfType([number, string]),\n        isPrimary: bool\n      },\n      getDefaultProps: function getDefaultProps() {\n        return {\n          isPrimary: false\n        };\n      }\n    }),\n    BottomPane: (0, _componentTypes.createClass)({\n      displayName: 'SplitHorizontal.BottomPane',\n      statics: {},\n      propTypes: {\n        children: node,\n        height: oneOfType([number, string]),\n        isPrimary: bool\n      },\n      getDefaultProps: function getDefaultProps() {\n        return {\n          isPrimary: false\n        };\n      }\n    }),\n    Divider: (0, _componentTypes.createClass)({\n      displayName: 'SplitHorizontal.Divider',\n      statics: {},\n      propTypes: {\n        children: node\n      }\n    })\n  },\n  getDefaultProps: function getDefaultProps() {\n    return {\n      isExpanded: true,\n      isAnimated: false,\n      collapseShift: 0,\n      onResizing: _noop3.default,\n      onResize: _noop3.default\n    };\n  },\n  getInitialState: function getInitialState() {\n    return {\n      collapseAmount: 250\n    };\n  },\n  getPanes: function getPanes() {\n    var children = this.props.children;\n    var _storedRefs = this.storedRefs,\n        topPaneRef = _storedRefs.topPane,\n        bottomPaneRef = _storedRefs.bottomPane;\n    var topPaneElement = (0, _get3.default)((0, _componentTypes.filterTypes)(children, SplitHorizontal.TopPane), 0, _react2.default.createElement(SplitHorizontal.TopPane, null));\n    var bottomPaneElement = (0, _get3.default)((0, _componentTypes.filterTypes)(children, SplitHorizontal.BottomPane), 0, _react2.default.createElement(SplitHorizontal.BottomPane, null));\n    var primaryElement = void 0,\n        primaryRef = void 0;\n    var secondaryElement = void 0,\n        secondaryRef = void 0;\n\n    if (topPaneElement.props.isPrimary && !bottomPaneElement.props.isPrimary) {\n      primaryElement = topPaneElement;\n      primaryRef = topPaneRef;\n      secondaryElement = bottomPaneElement;\n      secondaryRef = bottomPaneRef;\n    } else {\n      primaryElement = bottomPaneElement;\n      primaryRef = bottomPaneRef;\n      secondaryElement = topPaneElement;\n      secondaryRef = topPaneRef;\n    }\n\n    return {\n      top: topPaneElement.props,\n      bottom: bottomPaneElement.props,\n      primary: primaryElement.props,\n      primaryRef: primaryRef,\n      secondary: secondaryElement.props,\n      secondaryRef: secondaryRef\n    };\n  },\n  // Style changes to DOM nodes are updated here to shortcut the state -> render cycle for better performance. Also the Style updates in this\n  // function are entirely transient and can be flushed with a props update to `height`.\n  applyDeltaToSecondaryHeight: function applyDeltaToSecondaryHeight(dY, isExpanded, secondaryStartRect, secondaryRef, secondary, bottom, innerRef, primaryRef) {\n    var collapseShift = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 0;\n\n    if (isExpanded) {\n      secondaryRef.style.flexBasis = secondaryStartRect.height + dY * (secondary === bottom ? -1 : 1) + 'px';\n      return secondaryStartRect.height + dY * (secondary === bottom ? -1 : 1);\n    } else {\n      var overlapHeight = (secondary === bottom ? secondaryStartRect.height + dY : secondaryStartRect.height - dY) - collapseShift;\n\n      if (overlapHeight > 0) {\n        this.collapseSecondary(overlapHeight);\n        return secondaryStartRect.height - overlapHeight;\n      } else {\n        this.expandSecondary();\n        secondaryRef.style.flexBasis = (dY + collapseShift) * (secondary === bottom ? -1 : 1) + 'px';\n        return (dY + collapseShift) * (secondary === bottom ? -1 : 1);\n      }\n    }\n  },\n  expandSecondary: function expandSecondary() {\n    this.setState({\n      isExpanded: true\n    });\n  },\n  collapseSecondary: function collapseSecondary(collapseAmount) {\n    this.setState({\n      isExpanded: false,\n      collapseAmount: collapseAmount\n    });\n  },\n  disableAnimation: function disableAnimation(innerRef, secondaryRef, primaryRef) {\n    innerRef.style.transition = 'all 0s';\n    secondaryRef.style.transition = 'all 0s';\n    primaryRef.style.transition = 'all 0s';\n  },\n  resetAnimation: function resetAnimation(innerRef, secondaryRef, primaryRef) {\n    innerRef.style.transition = '';\n    secondaryRef.style.transition = '';\n    primaryRef.style.transition = '';\n  },\n  handleDragStart: function handleDragStart() {\n    this.panes = this.getPanes();\n    var _panes = this.panes,\n        secondaryRef = _panes.secondaryRef,\n        primaryRef = _panes.primaryRef;\n    this.secondaryStartRect = secondaryRef.getBoundingClientRect();\n    this.disableAnimation(this.storedRefs.inner, secondaryRef, primaryRef);\n  },\n  handleDrag: function handleDrag(_ref, _ref2) {\n    var dY = _ref.dY;\n    var event = _ref2.event;\n    var _props = this.props,\n        isExpanded = _props.isExpanded,\n        collapseShift = _props.collapseShift,\n        onResizing = _props.onResizing;\n    var _panes2 = this.panes,\n        secondaryRef = _panes2.secondaryRef,\n        secondary = _panes2.secondary,\n        bottom = _panes2.bottom,\n        primaryRef = _panes2.primaryRef;\n    onResizing(this.applyDeltaToSecondaryHeight(dY, isExpanded, this.secondaryStartRect, secondaryRef, secondary, bottom, this.storedRefs.inner, primaryRef, collapseShift), {\n      props: this.props,\n      event: event\n    });\n  },\n  handleDragEnd: function handleDragEnd(_ref3, _ref4) {\n    var dY = _ref3.dY;\n    var event = _ref4.event;\n    var _props2 = this.props,\n        isExpanded = _props2.isExpanded,\n        collapseShift = _props2.collapseShift,\n        onResize = _props2.onResize;\n    var _panes3 = this.panes,\n        secondaryRef = _panes3.secondaryRef,\n        secondary = _panes3.secondary,\n        bottom = _panes3.bottom,\n        primaryRef = _panes3.primaryRef;\n    onResize(this.applyDeltaToSecondaryHeight(dY, isExpanded, this.secondaryStartRect, secondaryRef, secondary, bottom, this.storedRefs.inner, primaryRef, collapseShift), {\n      props: this.props,\n      event: event\n    });\n    this.resetAnimation(this.storedRefs.inner, secondaryRef, primaryRef);\n  },\n  componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n    var isAnimated = nextProps.isAnimated,\n        isExpanded = nextProps.isExpanded,\n        collapseShift = nextProps.collapseShift;\n\n    var _getPanes = this.getPanes(),\n        secondaryRef = _getPanes.secondaryRef;\n\n    if (!isExpanded && ( // check if collapseShift changed or secondary pane collapsed\n    this.props.isExpanded || this.props.collapseShift !== collapseShift)) {\n      // collapse secondary\n      var secondaryRect = secondaryRef.getBoundingClientRect();\n      this.collapseSecondary(secondaryRect.height - collapseShift);\n    } else if (!this.props.isExpanded && isExpanded) {\n      // expand secondary\n      this.expandSecondary();\n    }\n\n    if (this.state.isAnimated !== isAnimated) {\n      this.setState({\n        isAnimated: isAnimated\n      });\n    }\n  },\n  componentDidMount: function componentDidMount() {\n    var _this = this;\n\n    var _props3 = this.props,\n        isAnimated = _props3.isAnimated,\n        isExpanded = _props3.isExpanded,\n        collapseShift = _props3.collapseShift;\n\n    var _getPanes2 = this.getPanes(),\n        secondaryRef = _getPanes2.secondaryRef;\n\n    if (isExpanded) {\n      // expand secondary\n      this.expandSecondary();\n    } else {\n      // collapse secondary\n      var secondaryRect = secondaryRef.getBoundingClientRect();\n      this.collapseSecondary(secondaryRect.height - collapseShift);\n    }\n\n    if (this.state.isAnimated !== isAnimated) {\n      (0, _defer3.default)(function () {\n        _this.setState({\n          isAnimated: isAnimated\n        });\n      });\n    }\n  },\n  storeRef: function storeRef(name) {\n    var _this2 = this;\n\n    return function (ref) {\n      _this2.storedRefs[name] = ref;\n    };\n  },\n  componentWillMount: function componentWillMount() {\n    this.storedRefs = {};\n  },\n  render: function render() {\n    var _this3 = this;\n\n    var _props4 = this.props,\n        children = _props4.children,\n        className = _props4.className,\n        passThroughs = _objectWithoutProperties(_props4, ['children', 'className']);\n\n    var _state = this.state,\n        isAnimated = _state.isAnimated,\n        isExpanded = _state.isExpanded,\n        collapseAmount = _state.collapseAmount;\n\n    var _getPanes3 = this.getPanes(),\n        topPaneProps = _getPanes3.top,\n        bottomPaneProps = _getPanes3.bottom,\n        secondary = _getPanes3.secondary;\n\n    var dividerProps = (0, _get3.default)((0, _first3.default)((0, _componentTypes.filterTypes)(children, SplitHorizontal.Divider)), 'props', {});\n    var from = void 0,\n        to = void 0;\n\n    if (!isExpanded) {\n      from = {\n        slideAmount: 0\n      };\n      to = {\n        slideAmount: collapseAmount\n      };\n    } else {\n      from = {\n        slideAmount: 0\n      };\n      to = {\n        slideAmount: 0\n      };\n    }\n\n    var isBottomSecondary = bottomPaneProps === secondary;\n    return _react2.default.createElement('div', _extends({}, (0, _componentTypes.omitProps)(passThroughs, SplitHorizontal), {\n      className: cx('&', {\n        '&-is-expanded': this.props.isExpanded,\n        '&-is-animated': this.props.isAnimated\n      }, className),\n      style: _extends({\n        flex: 1,\n        overflow: 'hidden'\n      }, passThroughs.style)\n    }), _react2.default.createElement(_reactMotion.Motion, {\n      defaultStyle: from,\n      style: isAnimated ? (0, _mapValues3.default)(to, function (val) {\n        return (0, _reactMotion.spring)(val, _motionSpring.QUICK_SLIDE_MOTION);\n      }) : to\n    }, function (tween) {\n      return _react2.default.createElement('div', {\n        className: cx('&-inner'),\n        ref: _this3.storeRef('inner'),\n        style: {\n          height: '100%',\n          display: 'flex',\n          flexDirection: 'column',\n          transform: 'translateY(' + (isBottomSecondary ? 1 : -1) * Math.round(tween.slideAmount) + 'px)'\n        }\n      }, _react2.default.createElement('div', _extends({}, (0, _componentTypes.omitProps)(topPaneProps, SplitHorizontal.TopPane), {\n        className: cx('&-TopPane', {\n          '&-is-secondary': topPaneProps === secondary\n        }, topPaneProps.className),\n        style: _extends({\n          flexGrow: isBottomSecondary ? 1 : 0,\n          flexShrink: isBottomSecondary ? 1 : 0,\n          flexBasis: (0, _isNil3.default)(topPaneProps.height) ? topPaneProps === secondary ? 'calc(50% - 3px)' : '0%' : topPaneProps.height,\n          marginTop: isBottomSecondary ? -Math.round(tween.slideAmount) : null,\n          overflow: 'auto'\n        }, topPaneProps.style),\n        ref: _this3.storeRef('topPane')\n      }), topPaneProps.children), _react2.default.createElement(_DragCaptureZone2.default, _extends({}, (0, _componentTypes.omitProps)(dividerProps, SplitHorizontal.Divider, [], false), {\n        className: cx('&-Divider', dividerProps.className),\n        onDragStart: _this3.handleDragStart,\n        onDrag: _this3.handleDrag,\n        onDragEnd: _this3.handleDragEnd,\n        style: _extends({\n          height: '6px',\n          boxSizing: 'border-box'\n        }, dividerProps.style)\n      }), dividerProps.children || ' '), _react2.default.createElement('div', _extends({}, (0, _componentTypes.omitProps)(bottomPaneProps, SplitHorizontal.BottomPane), {\n        className: cx('&-BottomPane', {\n          '&-is-secondary': bottomPaneProps === secondary\n        }, bottomPaneProps.className),\n        style: _extends({\n          flexGrow: !isBottomSecondary ? 1 : 0,\n          flexShrink: !isBottomSecondary ? 1 : 0,\n          flexBasis: (0, _isNil3.default)(bottomPaneProps.height) ? bottomPaneProps === secondary ? 'calc(50% - 3px)' : '0%' : bottomPaneProps.height,\n          marginBottom: isBottomSecondary ? null : -Math.round(tween.slideAmount),\n          overflow: 'auto'\n        }, bottomPaneProps.style),\n        ref: _this3.storeRef('bottomPane')\n      }), bottomPaneProps.children));\n    }));\n  }\n});\nexports.default = SplitHorizontal;","map":null,"metadata":{},"sourceType":"script"}