{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _isNull2 = require('lodash/isNull');\n\nvar _isNull3 = _interopRequireDefault(_isNull2);\n\nvar _get2 = require('lodash/get');\n\nvar _get3 = _interopRequireDefault(_get2);\n\nvar _delay2 = require('lodash/delay');\n\nvar _delay3 = _interopRequireDefault(_delay2);\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('react-peek/prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactMotion = require('react-motion');\n\nvar _motionSpring = require('../../constants/motion-spring');\n\nvar _styleHelpers = require('../../util/style-helpers');\n\nvar _componentTypes = require('../../util/component-types');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nvar cx = _styleHelpers.lucidClassNames.bind('&-Collapsible');\n\nvar any = _propTypes2.default.any,\n    bool = _propTypes2.default.bool,\n    node = _propTypes2.default.node,\n    number = _propTypes2.default.number,\n    string = _propTypes2.default.string;\nvar Collapsible = (0, _componentTypes.createClass)({\n  displayName: 'Collapsible',\n  statics: {},\n  _isPrivate: true,\n  propTypes: {\n    children: node,\n    className: string,\n    isExpanded: bool,\n    isAnimated: bool,\n    isMountControlled: bool,\n    mountControlThreshold: number,\n    rootType: any\n  },\n  getDefaultProps: function getDefaultProps() {\n    return {\n      isExpanded: true,\n      isAnimated: true,\n      isMountControlled: true,\n      mountControlThreshold: 4,\n      rootType: 'div'\n    };\n  },\n  getInitialState: function getInitialState() {\n    return {\n      maxHeight: null\n    };\n  },\n  storeRef: function storeRef(name) {\n    var _this = this;\n\n    return function (ref) {\n      _this.Refs[name] = ref;\n    };\n  },\n  componentWillMount: function componentWillMount() {\n    this.Refs = {};\n    this.isAnimated = false;\n    this.delayTimer = null;\n  },\n  componentDidMount: function componentDidMount() {\n    var _this2 = this;\n\n    (0, _delay3.default)(function () {\n      _this2.setState({\n        maxHeight: (0, _get3.default)(_this2.Refs, 'root.scrollHeight')\n      });\n\n      _this2.isAnimated = _this2.props.isAnimated;\n    }, 32);\n  },\n  componentDidUpdate: function componentDidUpdate() {\n    var _this3 = this;\n\n    this.isAnimated = false;\n    this.delayTimer = (0, _delay3.default)(function () {\n      if (_this3.props.isExpanded) {\n        var maxHeight = (0, _get3.default)(_this3.Refs, 'root.scrollHeight');\n\n        if (maxHeight !== _this3.state.maxHeight) {\n          _this3.setState({\n            maxHeight: maxHeight\n          });\n        }\n      }\n\n      _this3.isAnimated = _this3.props.isAnimated;\n    }, 32);\n  },\n  componentWillUnmount: function componentWillUnmount() {\n    this.delayTimer && clearTimeout(this.delayTimer);\n  },\n  render: function render() {\n    var _this4 = this;\n\n    var _props = this.props,\n        children = _props.children,\n        className = _props.className,\n        isExpanded = _props.isExpanded,\n        isMountControlled = _props.isMountControlled,\n        mountControlThreshold = _props.mountControlThreshold,\n        rootType = _props.rootType,\n        passThroughs = _objectWithoutProperties(_props, ['children', 'className', 'isExpanded', 'isMountControlled', 'mountControlThreshold', 'rootType']);\n\n    var maxHeight = this.state.maxHeight;\n    return _react2.default.createElement(_reactMotion.Motion, {\n      style: this.isAnimated ? {\n        height: isExpanded && !(0, _isNull3.default)(maxHeight) ? (0, _reactMotion.spring)(maxHeight, _motionSpring.QUICK_SLIDE_MOTION) : (0, _reactMotion.spring)(0, _motionSpring.QUICK_SLIDE_MOTION)\n      } : {\n        height: isExpanded && !(0, _isNull3.default)(maxHeight) ? maxHeight : 0\n      }\n    }, function (tween) {\n      return _react2.default.createElement(rootType, _extends({}, (0, _componentTypes.omitProps)(passThroughs, Collapsible), {\n        ref: _this4.storeRef('root'),\n        className: cx('&', className),\n        style: _extends({\n          height: tween.height !== maxHeight ? tween.height < 0 ? 0 : tween.height : null,\n          overflow: 'hidden',\n          padding: 0\n        }, passThroughs.style)\n      }), [_react2.default.createElement('div', {\n        key: 'content',\n        className: cx('&-content'),\n        style: {\n          margin: 0\n        }\n      }, isMountControlled && !isExpanded ? (0, _isNull3.default)(maxHeight) || Math.abs(tween.height) > mountControlThreshold ? children : null : children)]);\n    });\n  }\n});\nexports.default = Collapsible;","map":null,"metadata":{},"sourceType":"script"}